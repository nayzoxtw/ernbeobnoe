const toggle=document.getElementById("toggle"),statusText=document.getElementById("status"),robot=document.getElementById("robot");function setRobotStatus(e,t){statusText.innerHTML=e,robot.src=t}function messageActiveTab(e,t=(()=>{})){chrome.tabs.query({active:!0,currentWindow:!0},(function(o){chrome.tabs.sendMessage(o[0].id,e,t)}))}chrome.storage.local.get(["enabled"],(({enabled:e})=>{toggle.checked=!!e})),messageActiveTab({type:"isBoardPresent"},(e=>{e?chrome.storage.local.get(["isSolving"],(({isSolving:e})=>{toggle.checked?e?e&&setRobotStatus("Solving","solving.svg"):setRobotStatus("Idle","idle.svg"):setRobotStatus("Disabled","sleeping.svg")})):(setRobotStatus("No Board","sleeping.svg"),toggle.checked=!1)})),chrome.storage.onChanged.addListener((function(e){"isSolving"in e&&toggle.checked&&messageActiveTab({type:"isBoardPresent"},(function(t){t&&(e.isSolving.newValue?(statusText.innerHTML="Solving",robot.src="solving.svg"):(statusText.innerHTML="Idle",robot.src="idle.svg"))})),"enabled"in e&&(toggle.checked=e.enabled.newValue,statusText.innerHTML=e.enabled.newValue?"Solving":"Disabled",robot.src=e.enabled.newValue?"solving.svg":"sleeping.svg")})),toggle.addEventListener("change",(function(){if(toggle.checked)return chrome.storage.local.set({enabled:!0}),void setRobotStatus("Idle","idle.svg");chrome.storage.local.set({enabled:!1}),setRobotStatus("Idle","sleeping.svg")}));